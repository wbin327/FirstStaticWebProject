// let data =
//     `
// {
//     "company_logo": "./static/images/index-images/company-logo.png",
//     "project_introduction": "./static/images/index-images/project-msg.png",
//     "video": "./static/movies/Changsha%20Liuyang%20golf%20villa%20community-video.mp4",
//     "video_image": "./static/images/index-images/video-background.png",
//     "footer_image": "./static/images/index-images/footer-image.png",
//     "background_image": "./static/images/index-images/background.jpg",
//     "types": [
//         {
//             "nodeName": "项目背景",
//             "link": "{baseUrl}/list-page-v2/list-page-v2.html?typeIndex=0",
//             "iconPath": "{baseUrl}/static/images/index-images/project-background-ico.png",
//             "children": [
//                 {
//                     "nodeName": "项目背景",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=0&image_index=0",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images//project-images/project-background.png"]
//                 },
//                 {
//                     "nodeName": "区位分析",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=0&image_index=1",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images//project-images/location-analysis.png"]
//                 },
//                 {
//                     "nodeName": "周边现状",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=0&image_index=2",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images//project-images/around-analysis.png"]
//                 }
//             ]
//         },
//         {
//             "nodeName": "设计策略",
//             "link": "{baseUrl}/list-page-v2/list-page-v2.html?typeIndex=1",
//             "iconPath": "{baseUrl}/static/images/index-images/strategy-ico.png",
//             "children": [
//                 {
//                     "nodeName": "高尔夫精神",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=1&image_index=0",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/strategy-images/golf-spirit.png"]
//                 },
//                 {
//                     "nodeName": "绿色家园（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=1&image_index=1",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/strategy-images/green-home1.png",
//                         "{baseUrl}/static/images/details-page-images/strategy-images/green-home2.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "生态修复",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=1&image_index=3",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/strategy-images/ecology-repaired1.png"]
//                 }
//             ]
//         },
//         {
//             "nodeName": "设计成果",
//             "link": "{baseUrl}/list-page-v2/list-page-v2.html?typeIndex=2",
//             "iconPath": "{baseUrl}/static/images/index-images/gain-ico.png",
//             "children": [
//                 {
//                     "nodeName": "鸟瞰图",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=0",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/aerial-view.png"]
//                 },
//                 {
//                     "nodeName": "平台透视图",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=1",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/perspective.png"]
//                 },
//                 {
//                     "nodeName": "平台半鸟瞰图",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=2",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/binary-aerial-view.png"]
//                 },
//                 {
//                     "nodeName": "整体鸟瞰图",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=3",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/general-aerial-view.png"]
//                 },
//                 {
//                     "nodeName": "规划总平面（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=4",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/presentation-images/master-plan1.png",
//                         "{baseUrl}/static/images/details-page-images/presentation-images/master-plan2.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "指标表",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=6",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/ksslzb.png"]
//                 },
//                 {
//                     "nodeName": "B区放大总平面",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=7",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/b-size.png"]
//                 },
//                 {
//                     "nodeName": "分期规划",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=8",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/stage-planning.png"]
//                 },
//                 {
//                     "nodeName": "围合院落",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=9",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/yard.png"]
//                 },
//                 {
//                     "nodeName": "土方节省",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=10",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/save.png"]
//                 },
//                 {
//                     "nodeName": "设计核心",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=11",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/design.png"]
//                 },
//                 {
//                     "nodeName": "户型分析",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=12",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/apartment.png"]
//                 },
//                 {
//                     "nodeName": "采光同风",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=13",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/lighting.png"]
//                 },
//                 {
//                     "nodeName": "回归生活（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=14",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/presentation-images/life1.png",
//                         "{baseUrl}/static/images/details-page-images/presentation-images/life2.png",
//                         "{baseUrl}/static/images/details-page-images/presentation-images/life3.png",
//                         "{baseUrl}/static/images/details-page-images/presentation-images/life4.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "产品参数",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=18",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/product.png"]
//                 },
//                 {
//                     "nodeName": "功能分析图",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=19",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/function-analysis.png"]
//                 },
//                 {
//                     "nodeName": "景观分析",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=2&image_index=20",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/presentation-images/landcape-analysis.png"]
//                 }
//             ]
//         },
//         {
//             "nodeName": "产品图纸",
//             "link": "{baseUrl}/list-page-v2/list-page-v2.html?typeIndex=3",
//             "iconPath": "{baseUrl}/static/images/index-images/drawing-ico.png",
//             "children": [
//                 {
//                     "nodeName": "别墅共性优点",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=0",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/product-images/same-advantage.png"]
//                 },
//                 {
//                     "nodeName": "独栋A型",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=1",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/product-images/a-type.png"]
//                 },
//                 {
//                     "nodeName": "独栋B型（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=2",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/product-images/b-type1.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/b-type2.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "独栋C型（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=4",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/product-images/c-type1.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/c-type2.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "独栋别墅优点",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=6",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/product-images/single-advantage.png"]
//                 },
//                 {
//                     "nodeName": "叠拼别墅（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=7",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/product-images/diepin1.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/diepin2.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/diepin3.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/diepin4.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "叠拼别墅优点",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=11",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/product-images/diepin-advantage.png"]
//                 },
//                 {
//                     "nodeName": "联排别墅（多）",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=12",
//                     "imagesPath": [
//                         "{baseUrl}/static/images/details-page-images/product-images/townhouse1.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/townhouse2.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/townhouse3.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/townhouse4.png",
//                         "{baseUrl}/static/images/details-page-images/product-images/townhouse5.png"
//                     ]
//                 },
//                 {
//                     "nodeName": "联排别墅优点",
//                     "link": "{baseUrl}/details-page/details-page-v2.html?typeIndex=3&image_index=17",
//                     "imagesPath": ["{baseUrl}/static/images/details-page-images/product-images/townhouse-advantage.png"]
//                 }
//             ]
//         }
//     ]
// }
//     `
// 导航栏html
let sidebar_html = `
<div class="right-sidebar-ico" id="right-sidebar-ico">
    <img src="{baseUrl}/static/component/right-sidebar/images/homeico.png">
</div>
<div class="right-sidebar" style="display: none;">
    <div class="main-sidebar">
        <div class="sidebar-close" id="sidebar-close">
            <img src="{baseUrl}/static/component/right-sidebar/images/closeico.png">
        </div>
        <div class="sidebar-logo">
            <img src="{baseUrl}/static/component/right-sidebar/images/right-sidebar-logo.png">
        </div>
        {{~it.types:value:index}}
        <a href="{{=value.link}}" class="main-sidebar-button" index="{{=index}}">{{=value.nodeName}}</a>
        {{~}}
    </div>
    <div class="secondary-sidebar" style="display: none;">
        <div class="secondary-button-group"></div>
    </div>
</div>
`

// 渲染侧边栏
render_right_sidebar()
function render_right_sidebar(){
    // 从sessionStorage中获取用户数据
    let sessionStorageData = localStorage.getItem("user_data");
    if(sessionStorageData){
        data = sessionStorageData;
    }
    data = JSON.parse(data);

    // console.log(data);
    sidebar_html = sidebar_html.format({'baseUrl': baseUrl});
    // 内容渲染
    sidebar_html =  doT.template(sidebar_html)(data);
    // console.log(sidebar_html);
    // 为页面添加侧边栏,只需要在页面中声明<div class="right-sidebar" id="right-sidebar></div>,自动往该标签中添加元素
    $(".right-sidebar-component").html(sidebar_html);
    // 引入导航栏样式
    $("head").append("<link>");
    css = $("head").children(":last");
    css.attr({
        rel: "stylesheet",
        type: "text/css",
        // href: "/static/component/right-sidebar/css/right-sidebar.css",
        href: "{baseUrl}/static/component/right-sidebar-v2/css/right-sidebar.css".format({'baseUrl': baseUrl}),
    });
}


// 侧边栏相关JS
$("#sidebar-close img").click(function () {
    $(".right-sidebar").fadeOut();
    $('.secondary-sidebar').hide();
})
$("#right-sidebar-ico").click(function () {
    $(".right-sidebar").fadeIn();
})

let secondary_sidebar =
    `
    {{~it:value:index}}
        <div class="secondary-button">
            <a href="{{=value.link}}">{{=value.nodeName}}</a>
        </div>
    {{~}}
    `;

// 鼠标滑过时显示相应的导航栏
$(".main-sidebar a").hover(function (e) {
        // 显示子导航栏
        $('.secondary-sidebar').show();
        // let type_name = e.currentTarget.innerText;
        // 获取当前元素的索引
        let index = e.currentTarget.getAttribute("index");
        let html = doT.template(secondary_sidebar)(data.types[index].children);
        // 删除添加子元素
        $('.secondary-button-group').empty();
        $('.secondary-button-group').append(html);
    },
    function () {
        // $('.secondary-button-group').empty();
        // 离开时隐藏
        // $('.secondary-sidebar').hide();
    })
// $(".main-sidebar").mouseenter(function () {
//     $('.secondary-sidebar').hide();
// })

// 侧边栏LOGO跳转首页
$(".sidebar-logo").click(function () {
    window.location.href = linkTree[0]
})
